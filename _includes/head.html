{% include seo-defaults.html %}
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<!-- Title and meta description are handled by Jekyll SEO plugin below -->

<!-- Performance Optimizations -->
{% include performance-optimizations.html %}

<!-- DNS Prefetch and Preconnect for Performance -->
<link rel="dns-prefetch" href="https://fonts.googleapis.com">
<link rel="dns-prefetch" href="https://fonts.gstatic.com">
<link rel="dns-prefetch" href="https://www.googletagmanager.com">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

<!-- CSS Files -->
<link rel="stylesheet" href="{{ '/css/styles.css' | relative_url }}">
<link rel="stylesheet" href="{{ '/css/spacing-improvements.css' | relative_url }}">
<!-- Enhanced Navigation with All Services -->
<link rel="stylesheet" href="{{ '/css/navigation-enhanced.css' | relative_url }}">
<!-- Complete Navigation Solution - Replaces all partial fixes -->
<link rel="stylesheet" href="{{ '/css/navigation-complete-fix.css' | relative_url }}">
<!-- Navigation Override Fix - MUST load last to override all navigation styles -->
<link rel="stylesheet" href="{{ '/css/navigation-fix-override.css' | relative_url }}">
<!-- Mobile Navigation Fix -->
<link rel="stylesheet" href="{{ '/css/mobile-navigation-fix.css' | relative_url }}">

<!-- Enhanced Critical CSS - Mobile First -->
<style>
/* Critical CSS - Mobile First Approach */
:root{--primary-color:#1e3a8a;--secondary-color:#3730a3;--accent-color:#dc2626;--dark-text:#1f2937;--light-text:#6b7280;--background:#ffffff;--light-bg:#f9fafb;--border-color:#e5e7eb;--success:#059669;--max-width:1200px;--transition-fast:0.2s ease;--transition-normal:0.3s ease}

/* Reset and Base */
*{margin:0;padding:0;box-sizing:border-box}
html{-webkit-text-size-adjust:100%;font-size:16px}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;line-height:1.6;color:var(--dark-text);background:var(--background);-webkit-font-smoothing:antialiased}

/* Mobile First Container */
.container{width:100%;max-width:var(--max-width);margin:0 auto;padding:0 1rem}


/* Force hide TOC on mobile */
@media (max-width: 768px) {
  .toc,.toc__menu,.toc__title,.sidebar__right,.sidebar,nav.toc,aside.sidebar__right,[class*="toc"],[class*="table-of-contents"],[id*="toc"],.mobile-toc,.table-of-contents{display:none!important;visibility:hidden!important;width:0!important;height:0!important;overflow:hidden!important;position:absolute!important;left:-9999px!important}
}

/* Mobile Hero */
.hero{background:linear-gradient(135deg,var(--primary-color) 0%,var(--secondary-color) 100%);color:white;padding:3rem 0}
.hero-content{text-align:center}
.hero h1{font-size:1.75rem;font-weight:700;margin-bottom:1rem;line-height:1.2}
.hero-subtitle{font-size:1rem;margin-bottom:1.5rem;opacity:0.95;line-height:1.5}

/* Mobile Buttons */
.btn{display:inline-flex;align-items:center;justify-content:center;padding:0.875rem 1.5rem;border-radius:6px;font-weight:600;text-align:center;transition:all 0.3s ease;font-size:1rem;cursor:pointer;text-decoration:none;min-height:44px}
.btn-primary{background:white;color:var(--primary-color)}
.btn-secondary{background:transparent;color:white;border:2px solid white}
.hero-cta{display:flex;flex-direction:column;gap:0.75rem;margin-top:1.5rem;padding:0 1rem}
.hero-cta .btn{width:100%}

/* Mobile Content */
section{padding:3rem 0}
h2{font-size:1.5rem;margin-bottom:1rem;line-height:1.2}
h3{font-size:1.25rem;margin-bottom:0.75rem}
p{margin-bottom:1rem}

/* Mobile Cards */
.services-grid,.credentials-grid,.locations-grid,.practice-areas-chips{display:grid;gap:1rem;margin-top:1.5rem}
.service-card,.credential,.location-card{background:var(--light-bg);padding:1.5rem;border-radius:8px}
.practice-areas-strip{background:var(--light-bg);padding:1rem 0;min-height:60px}
.practice-chip{background:white;padding:0.5rem 1rem;border-radius:20px;font-size:0.875rem;white-space:nowrap;min-height:36px;display:inline-flex;align-items:center;text-decoration:none;color:var(--dark-text)}

/* Tablet Styles */
@media (min-width:768px){
  .container{padding:0 2rem}
  .main-nav{position:sticky;top:0;height:auto}
  main{padding-top:0}
  body{padding-top:0}
  .nav-wrapper{padding:1rem 0}
  .logo{font-size:1.25rem}
  .logo span{display:inline}
  .mobile-menu-toggle{display:none}
  .nav-menu{position:static;left:auto;top:auto;width:auto;height:auto;flex-direction:row;padding:0;gap:2rem;background:transparent;overflow:visible}
  .nav-menu a{padding:0.5rem 0;border:none;font-size:0.9375rem}
  .hero{padding:5rem 0}
  .hero h1{font-size:2.5rem}
  .hero-subtitle{font-size:1.25rem}
  .hero-cta{flex-direction:row;justify-content:center;padding:0}
  .hero-cta .btn{width:auto}
  .services-grid{grid-template-columns:repeat(2,1fr);gap:2rem}
  .credentials-grid{grid-template-columns:repeat(2,1fr)}
  .locations-grid{grid-template-columns:repeat(3,1fr)}
  .practice-areas-chips{display:flex;flex-wrap:wrap;justify-content:center;gap:0.5rem}
  section{padding:4rem 0}
  h2{font-size:2rem}
}

/* Desktop Styles */
@media (min-width:1024px){
  .services-grid{grid-template-columns:repeat(3,1fr)}
  .credentials-grid{grid-template-columns:repeat(3,1fr)}
  .locations-grid{grid-template-columns:repeat(4,1fr)}
}

/* Prevent Layout Shift */
.loading-placeholder{min-height:100vh;background:var(--background)}
img{max-width:100%;height:auto}
@media print{.main-nav{position:static!important}}
</style>

<!-- Load CSS asynchronously with priority -->
<link rel="preload" href="{{ '/css/styles.min.css?v=9' | relative_url }}" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="{{ '/css/styles.min.css?v=9' | relative_url }}"></noscript>

<!-- Mobile optimizations CSS -->
<link rel="preload" href="{{ '/css/mobile-optimized.css?v=3' | relative_url }}" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="{{ '/css/mobile-optimized.css?v=3' | relative_url }}"></noscript>

<!-- Mobile Theme Fixes CSS -->
<link rel="stylesheet" href="{{ '/css/mobile-theme-fixes.css?v=3' | relative_url }}">

<!-- Complete Mobile Fixes CSS -->
<link rel="stylesheet" href="{{ '/css/mobile-complete-fix.css?v=2' | relative_url }}">

<!-- Navigation Override Fix - Load absolutely last to override everything -->
<script>
// Ensure navigation override CSS loads after all other stylesheets
window.addEventListener('load', function() {
  var link = document.createElement('link');
  link.rel = 'stylesheet';
  link.href = '{{ '/css/navigation-fix-override.css?v=2' | relative_url }}';
  document.head.appendChild(link);
  
  // Load ultimate fix after a short delay to ensure it's absolutely last
  setTimeout(function() {
    var ultimateLink = document.createElement('link');
    ultimateLink.rel = 'stylesheet';
    ultimateLink.href = '{{ '/css/navigation-ultimate-fix.css?v=1' | relative_url }}';
    document.head.appendChild(ultimateLink);
  }, 100);
});
</script>

<!-- Remove Mobile TOC Script -->
<script src="{{ '/js/remove-mobile-toc.js' | relative_url }}"></script>
<!-- Mobile Navigation Enhancement -->
<script src="{{ '/js/mobile-navigation.js' | relative_url }}" defer></script>

<!-- Optimized Font Loading - Non-blocking -->
<script>
// Non-blocking font loading
(function(){
  if('fonts' in document){
    Promise.all([
      new FontFace('Inter','url(https://fonts.gstatic.com/s/inter/v12/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuLyfAZ9hiA.woff2) format("woff2")',{weight:'400',display:'swap'}),
      new FontFace('Inter','url(https://fonts.gstatic.com/s/inter/v12/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuGKYAZ9hiA.woff2) format("woff2")',{weight:'600',display:'swap'}),
      new FontFace('Inter','url(https://fonts.gstatic.com/s/inter/v12/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuFuYAZ9hiA.woff2) format("woff2")',{weight:'700',display:'swap'})
    ].map(f=>f.load())).then(fonts=>{
      fonts.forEach(f=>document.fonts.add(f));
      document.documentElement.classList.add('fonts-loaded');
    }).catch(()=>{
      // Fallback
      var l=document.createElement('link');
      l.rel='stylesheet';
      l.href='https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap';
      l.media='print';
      l.onload=function(){this.media='all'};
      document.head.appendChild(l);
    });
  }else{
    // Legacy browsers
    var l=document.createElement('link');
    l.rel='stylesheet';
    l.href='https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap';
    document.head.appendChild(l);
  }
})();
</script>
{% seo %}

<!-- Additional SEO Enhancements -->
{% include seo-enhancements.html %}

<!-- Deferred Scripts -->
<script>
// Navigation functionality
document.addEventListener('DOMContentLoaded',function(){
  const toggle=document.querySelector('.mobile-menu-toggle');
  const menu=document.querySelector('.nav-menu');
  if(toggle&&menu){
    toggle.addEventListener('click',function(){
      menu.classList.toggle('active');
      toggle.classList.toggle('active');
      document.body.classList.toggle('menu-open');
    });
  }
});

// Lazy load Google Analytics
window.dataLayer=window.dataLayer||[];
function gtag(){dataLayer.push(arguments);}
let gaLoaded=false;
function loadGA(){
  if(!gaLoaded){
    gaLoaded=true;
    const s=document.createElement('script');
    s.async=true;
    s.src='https://www.googletagmanager.com/gtag/js?id=G-JNK2QCYSC7';
    s.onload=()=>{
      gtag('js',new Date());
      gtag('config','G-JNK2QCYSC7');
    };
    document.head.appendChild(s);
  }
}
// Load on interaction or after delay
if('requestIdleCallback' in window){
  requestIdleCallback(loadGA,{timeout:3000});
}else{
  setTimeout(loadGA,3000);
}
['click','scroll','touchstart'].forEach(e=>{
  window.addEventListener(e,loadGA,{once:true,passive:true});
});

// Track phone/email clicks
function trackPhoneClick(){
  if(typeof gtag!=='undefined'){
    gtag('event','phone_call',{event_category:'engagement',event_label:'phone_number_click'});
  }
}
function trackEmailClick(){
  if(typeof gtag!=='undefined'){
    gtag('event','email_click',{event_category:'engagement',event_label:'email_address_click'});
  }
}
</script>

<!-- Structured Data -->
<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "ProfessionalService",
    "name": "{{ site.title }}",
    "description": "{{ site.description }}",
    "url": "{{ site.url }}",
    "telephone": "{{ site.phone }}",
    "address": {
        "@type": "PostalAddress",
        "streetAddress": "{{ site.address }}",
        "addressLocality": "Smithfield",
        "addressRegion": "RI",
        "addressCountry": "US"
    },
    "areaServed": ["Rhode Island", "Massachusetts", "Connecticut", "New Hampshire", "Vermont", "Maine"],
    "priceRange": "$$$$"
}
</script>

<!-- FAQ Schema - Include if page has FAQs -->
{% include faq-schema.html %}
