document.addEventListener("DOMContentLoaded",function(){const mobileMenuToggle=document.querySelector(".mobile-menu-toggle");const navMenu=document.querySelector(".nav-menu");const mobileNavOverlay=document.createElement("div");mobileNavOverlay.className="mobile-nav-overlay";document.body.appendChild(mobileNavOverlay);if(mobileMenuToggle&&navMenu){mobileMenuToggle.addEventListener("click",function(){navMenu.classList.toggle("active");mobileNavOverlay.classList.toggle("active");this.classList.toggle("active");const expanded=this.getAttribute("aria-expanded")==="true";this.setAttribute("aria-expanded",!expanded);document.body.classList.toggle("menu-open")})}const dropdowns=document.querySelectorAll(".has-dropdown");dropdowns.forEach(dropdown=>{const link=dropdown.querySelector("a");if(link&&window.innerWidth<=768){link.addEventListener("click",function(e){if(dropdown.querySelector(".dropdown")){if(!dropdown.classList.contains("active")){e.preventDefault();dropdown.classList.add("active")}}})}});const navLinks=document.querySelectorAll(".nav-menu a");navLinks.forEach(link=>{link.addEventListener("click",function(e){if(!this.parentElement.classList.contains("has-dropdown")||!this.parentElement.querySelector(".dropdown")){if(navMenu)navMenu.classList.remove("active");if(mobileNavOverlay)mobileNavOverlay.classList.remove("active");if(mobileMenuToggle)mobileMenuToggle.classList.remove("active");if(mobileMenuToggle)mobileMenuToggle.setAttribute("aria-expanded","false");document.body.classList.remove("menu-open")}})});mobileNavOverlay.addEventListener("click",function(){if(navMenu)navMenu.classList.remove("active");if(mobileNavOverlay)mobileNavOverlay.classList.remove("active");if(mobileMenuToggle)mobileMenuToggle.setAttribute("aria-expanded","false");if(mobileMenuToggle)mobileMenuToggle.classList.remove("active");document.body.classList.remove("menu-open")});document.addEventListener("click",function(event){if(!event.target.closest(".nav-wrapper")&&!event.target.closest(".nav-menu")){navMenu.classList.remove("active");mobileNavOverlay.classList.remove("active");mobileMenuToggle.classList.remove("active");mobileMenuToggle.setAttribute("aria-expanded","false");document.body.classList.remove("menu-open")}});document.querySelectorAll('a[href^="#"]').forEach(anchor=>{anchor.addEventListener("click",function(e){e.preventDefault();const target=document.querySelector(this.getAttribute("href"));if(target){target.scrollIntoView({behavior:"smooth",block:"start"})}})});let lastScrollTop=0;const nav=document.querySelector(".main-nav");let ticking=false;function updateNavOnScroll(){if(!nav)return;let scrollTop=window.pageYOffset||document.documentElement.scrollTop;if(window.innerWidth>768){if(scrollTop>lastScrollTop&&scrollTop>100){nav.style.transform="translateY(-100%)"}else{nav.style.transform="translateY(0)"}}if(scrollTop>10){nav.classList.add("scrolled")}else{nav.classList.remove("scrolled")}lastScrollTop=scrollTop;ticking=false}const observerOptions={threshold:.1,rootMargin:"0px 0px -50px 0px"};const observer=new IntersectionObserver(entries=>{entries.forEach(entry=>{if(entry.isIntersecting){entry.target.classList.add("fade-in-up");observer.unobserve(entry.target)}})},observerOptions);const elementsToAnimate=document.querySelectorAll(".service-card, .benefit-card, .testimonial, .case-study, .publication-card, .location-card");elementsToAnimate.forEach(el=>{observer.observe(el)});window.addEventListener("scroll",function(){if(!ticking){window.requestAnimationFrame(updateNavOnScroll);ticking=true}});const lazyImages=document.querySelectorAll("img[data-src]");if("IntersectionObserver"in window){const imageObserver=new IntersectionObserver((entries,observer)=>{entries.forEach(entry=>{if(entry.isIntersecting){const img=entry.target;img.src=img.dataset.src;img.removeAttribute("data-src");imageObserver.unobserve(img)}})});lazyImages.forEach(img=>imageObserver.observe(img))}const forms=document.querySelectorAll("form");forms.forEach(form=>{form.addEventListener("submit",function(e){const submitBtn=form.querySelector('button[type="submit"]');if(submitBtn){submitBtn.classList.add("loading");submitBtn.disabled=true;const originalText=submitBtn.innerHTML;submitBtn.innerHTML='<span class="loading-dots"><span></span><span></span><span></span></span> Processing...';setTimeout(()=>{submitBtn.classList.remove("loading");submitBtn.disabled=false;submitBtn.innerHTML=originalText},1e4)}});const inputs=form.querySelectorAll("input[required], textarea[required]");inputs.forEach(input=>{input.addEventListener("blur",function(){if(this.value.trim()===""){this.classList.add("error");this.classList.remove("success")}else{this.classList.remove("error");this.classList.add("success")}});input.addEventListener("input",function(){if(this.classList.contains("error")&&this.value.trim()!==""){this.classList.remove("error");this.classList.add("success")}})})});const buttons=document.querySelectorAll(".btn, button");buttons.forEach(button=>{button.addEventListener("click",function(e){const ripple=document.createElement("span");const rect=this.getBoundingClientRect();const size=Math.max(rect.width,rect.height);const x=e.clientX-rect.left-size/2;const y=e.clientY-rect.top-size/2;ripple.style.width=ripple.style.height=size+"px";ripple.style.left=x+"px";ripple.style.top=y+"px";ripple.classList.add("ripple");this.appendChild(ripple);setTimeout(()=>{ripple.remove()},600)})});const faqItems=document.querySelectorAll(".faq-item");faqItems.forEach(item=>{const summary=item.querySelector("summary");if(summary){summary.addEventListener("click",function(e){e.preventDefault();if(window.innerWidth<=768){faqItems.forEach(otherItem=>{if(otherItem!==item&&otherItem.hasAttribute("open")){otherItem.removeAttribute("open")}})}if(item.hasAttribute("open")){item.removeAttribute("open")}else{item.setAttribute("open","")}})}});function generateMobileTOC(){return;const headings=document.querySelectorAll("h2, h3, h4");if(headings.length<3)return;const tocContainer=document.createElement("div");tocContainer.className="mobile-toc collapsed";const tocHeader=document.createElement("div");tocHeader.className="mobile-toc-header";tocHeader.textContent="Table of Contents";const tocContent=document.createElement("div");tocContent.className="mobile-toc-content";const tocList=document.createElement("ul");headings.forEach((heading,index)=>{if(!heading.id){heading.id="heading-"+index}const listItem=document.createElement("li");const link=document.createElement("a");link.href="#"+heading.id;link.textContent=heading.textContent;link.className=heading.tagName.toLowerCase()==="h2"?"toc-h2":heading.tagName.toLowerCase()==="h3"?"toc-h3":"toc-h4";listItem.appendChild(link);tocList.appendChild(listItem)});tocContent.appendChild(tocList);tocContainer.appendChild(tocHeader);tocContainer.appendChild(tocContent);const mainContent=document.querySelector("main")||document.querySelector(".container");const firstP=mainContent?.querySelector("p");if(firstP){firstP.parentNode.insertBefore(tocContainer,firstP.nextSibling)}else if(mainContent){mainContent.insertBefore(tocContainer,mainContent.firstChild)}tocHeader.addEventListener("click",function(){tocContainer.classList.toggle("collapsed")});const updateActiveTOC=()=>{const scrollPosition=window.scrollY+100;let activeHeading=null;headings.forEach(heading=>{if(heading.offsetTop<=scrollPosition){activeHeading=heading}});tocList.querySelectorAll("a").forEach(link=>link.classList.remove("active"));if(activeHeading){const activeLink=tocList.querySelector(`a[href="#${activeHeading.id}"]`);if(activeLink)activeLink.classList.add("active")}};window.addEventListener("scroll",updateActiveTOC);updateActiveTOC()}function createBackToTopButton(){const backToTopBtn=document.createElement("button");backToTopBtn.className="back-to-top";backToTopBtn.innerHTML="â†‘";backToTopBtn.setAttribute("aria-label","Back to top");backToTopBtn.setAttribute("title","Back to top");document.body.appendChild(backToTopBtn);const toggleBackToTop=()=>{if(window.scrollY>300){backToTopBtn.classList.add("visible")}else{backToTopBtn.classList.remove("visible")}};backToTopBtn.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})});window.addEventListener("scroll",toggleBackToTop);toggleBackToTop()}function initializeAccordions(){const accordions=document.querySelectorAll(".accordion");accordions.forEach(accordion=>{const header=accordion.querySelector(".accordion-header");if(header){header.addEventListener("click",function(){accordion.classList.toggle("open");const group=accordion.closest(".accordion-group");if(group){const siblings=group.querySelectorAll(".accordion");siblings.forEach(sibling=>{if(sibling!==accordion){sibling.classList.remove("open")}})}})}})}function enhanceMobileForms(){const forms=document.querySelectorAll("form");forms.forEach(form=>{const formGroups=form.querySelectorAll(".form-group");formGroups.forEach(group=>{if(window.innerWidth<=768){group.classList.add("mobile-form-group")}});const inputs=form.querySelectorAll("input, textarea, select");inputs.forEach(input=>{input.addEventListener("focus",function(){if(window.innerWidth<=768){setTimeout(()=>{this.scrollIntoView({behavior:"smooth",block:"center"})},300)}})})})}function enhanceTouchTargets(){const clickableElements=document.querySelectorAll("a, button, .clickable, .btn");clickableElements.forEach(element=>{element.classList.add("touch-target")})}function optimizeViewport(){let viewportMeta=document.querySelector('meta[name="viewport"]');if(viewportMeta){viewportMeta.setAttribute("content","width=device-width, initial-scale=1.0, user-scalable=yes, viewport-fit=cover")}else{viewportMeta=document.createElement("meta");viewportMeta.name="viewport";viewportMeta.content="width=device-width, initial-scale=1.0, user-scalable=yes, viewport-fit=cover";document.head.appendChild(viewportMeta)}}if(window.innerWidth<=768){generateMobileTOC()}createBackToTopButton();initializeAccordions();enhanceMobileForms();enhanceTouchTargets();optimizeViewport();let resizeTimeout;window.addEventListener("resize",function(){clearTimeout(resizeTimeout);resizeTimeout=setTimeout(function(){if(window.innerWidth<=768){enhanceMobileForms();if(!document.querySelector(".mobile-toc")){generateMobileTOC()}}},250)});let touchStartX=0;let touchEndX=0;document.addEventListener("touchstart",function(e){touchStartX=e.changedTouches[0].screenX});document.addEventListener("touchend",function(e){touchEndX=e.changedTouches[0].screenX;handleSwipe()});function handleSwipe(){const swipeThreshold=50;const swipeDistance=touchEndX-touchStartX;if(swipeDistance>swipeThreshold&&!navMenu.classList.contains("active")){if(touchStartX<50){navMenu.classList.add("active");mobileNavOverlay.classList.add("active");mobileMenuToggle.classList.add("active");document.body.classList.add("menu-open")}}if(swipeDistance<-swipeThreshold&&navMenu.classList.contains("active")){navMenu.classList.remove("active");mobileNavOverlay.classList.remove("active");mobileMenuToggle.classList.remove("active");document.body.classList.remove("menu-open")}}function initializeIconEnhancements(){const serviceCards=document.querySelectorAll(".service-card");serviceCards.forEach(card=>{const icon=card.querySelector(".service-icon");if(icon){card.addEventListener("mouseenter",()=>{icon.classList.add("icon-pulse")});card.addEventListener("mouseleave",()=>{icon.classList.remove("icon-pulse")})}});const benefitIcons=document.querySelectorAll(".benefit-icon");const iconObserver=new IntersectionObserver(entries=>{entries.forEach((entry,index)=>{if(entry.isIntersecting){setTimeout(()=>{entry.target.classList.add("icon-bounce");setTimeout(()=>{entry.target.classList.remove("icon-bounce")},1e3)},index*200);iconObserver.unobserve(entry.target)}})});benefitIcons.forEach(icon=>iconObserver.observe(icon));const practiceChips=document.querySelectorAll(".practice-chip");practiceChips.forEach(chip=>{const icon=chip.querySelector(".icon");if(icon){chip.addEventListener("mouseenter",()=>{icon.style.transform="scale(1.2) rotate(5deg)"});chip.addEventListener("mouseleave",()=>{icon.style.transform="scale(1) rotate(0deg)"})}});const fab=document.querySelector(".fab");if(fab){fab.addEventListener("mouseenter",()=>{fab.style.transform="scale(1.1) translateY(-4px)"});fab.addEventListener("mouseleave",()=>{fab.style.transform="scale(1) translateY(0)"});fab.addEventListener("click",()=>{fab.style.transform="scale(0.95) translateY(2px)";setTimeout(()=>{fab.style.transform="scale(1.1) translateY(-4px)"},150)});fab.addEventListener("mouseenter",()=>{fab.classList.remove("fab-pulse")})}const contactIcons=document.querySelectorAll(".contact-icon");contactIcons.forEach(icon=>{const parentLink=icon.closest("a")||icon.nextElementSibling;if(parentLink){parentLink.addEventListener("mouseenter",()=>{icon.style.transform="scale(1.2)";icon.style.background="rgba(255,255,255,0.4)"});parentLink.addEventListener("mouseleave",()=>{icon.style.transform="scale(1)";icon.style.background="rgba(255,255,255,0.2)"})}});const buttonsWithIcons=document.querySelectorAll(".btn-with-icon");buttonsWithIcons.forEach(button=>{const icon=button.querySelector(".btn-icon");if(icon){button.addEventListener("mouseenter",()=>{icon.style.transform="translateX(4px) scale(1.1)"});button.addEventListener("mouseleave",()=>{icon.style.transform="translateX(0) scale(1)"})}})}initializeIconEnhancements();window.addEventListener("load",function(){const criticalElements=document.querySelectorAll(".hero, .hero h1, .hero p, .hero .btn, .trust-indicators, .services-grid, .main-nav");criticalElements.forEach(el=>{if(el){el.style.opacity="1";el.style.visibility="visible";el.style.transform="none"}});const allElements=document.querySelectorAll("*");const hiddenElements=[];const intentionallyHidden=["dropdown","mobile-nav-overlay","mobile-menu-toggle"];allElements.forEach(el=>{const shouldSkip=intentionallyHidden.some(className=>el.classList.contains(className)||el.closest(`.${className}`));if(!shouldSkip){const style=window.getComputedStyle(el);if(style.opacity==="0"||style.visibility==="hidden"||style.display==="none"){const rect=el.getBoundingClientRect();if(rect.width>0&&rect.height>0&&rect.top<window.innerHeight){hiddenElements.push({element:el,className:el.className,id:el.id,tagName:el.tagName.toLowerCase()})}}}});if(hiddenElements.length>0){console.warn("Hidden elements found:",hiddenElements)}});function addProgressiveLoading(){const images=document.querySelectorAll("img[data-src]");images.forEach(img=>{const imageObserver=new IntersectionObserver((entries,observer)=>{entries.forEach(entry=>{if(entry.isIntersecting){const img=entry.target;img.src=img.dataset.src;img.removeAttribute("data-src");imageObserver.unobserve(img)}})});imageObserver.observe(img)})}addProgressiveLoading();function enhanceFormVisuals(){const inputs=document.querySelectorAll("input, textarea, select");inputs.forEach(input=>{input.addEventListener("focus",()=>{input.style.transform="scale(1.02)";input.style.boxShadow="0 4px 12px rgba(30, 58, 138, 0.15)"});input.addEventListener("blur",()=>{input.style.transform="scale(1)";input.style.boxShadow=""});input.addEventListener("input",()=>{if(input.checkValidity()){input.classList.remove("error");input.classList.add("success")}else{input.classList.remove("success");if(input.value.length>0){input.classList.add("error")}}})})}enhanceFormVisuals()});