<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Present Value Calculator - Economic Damage Analysis Tool | Skerritt Economics</title>
    <meta name="description" content="Professional present value calculator for forensic economists and attorneys. Calculate PV of future economic losses with appropriate discount rates for litigation support.">
    <link rel="stylesheet" href="../../css/styles.css">
    <link rel="stylesheet" href="../../css/services.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<style>
    .tool-container {
        background-color: white;
        padding: 30px;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        margin: 20px 0;
    }
    .tool-header {
        text-align: center;
        margin-bottom: 30px;
        padding-bottom: 20px;
        border-bottom: 2px solid #007bff;
    }
    .tool-header h1 {
        color: #333;
        margin-bottom: 10px;
    }
    .tool-description {
        color: #666;
        font-size: 16px;
        max-width: 600px;
        margin: 0 auto;
    }
    .form-group {
        margin-bottom: 20px;
    }
    .form-group label {
        display: block;
        margin-bottom: 5px;
        font-weight: bold;
        color: #555;
    }
    .form-group input, .form-group select {
        width: 100%;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 5px;
        font-size: 16px;
        box-sizing: border-box;
    }
    .input-help {
        font-size: 12px;
        color: #666;
        margin-top: 3px;
    }
    .two-column {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
    }
    .three-column {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        gap: 20px;
    }
    @media (max-width: 768px) {
        .two-column, .three-column {
            grid-template-columns: 1fr;
        }
    }
    .calculate-btn {
        width: 100%;
        padding: 15px;
        background-color: #007bff;
        color: white;
        border: none;
        border-radius: 5px;
        font-size: 18px;
        cursor: pointer;
        margin-top: 20px;
        transition: background-color 0.3s;
    }
    .calculate-btn:hover {
        background-color: #0056b3;
    }
    .calculate-btn:disabled {
        background-color: #ccc;
        cursor: not-allowed;
    }
    .results {
        margin-top: 30px;
        padding: 20px;
        background-color: #f8f9fa;
        border-radius: 5px;
        border-left: 4px solid #007bff;
    }
    .results h2 {
        color: #333;
        margin-top: 0;
    }
    .result-section {
        margin-bottom: 20px;
    }
    .result-section h3 {
        color: #555;
        border-bottom: 1px solid #ddd;
        padding-bottom: 5px;
    }
    .result-item {
        padding: 8px 0;
        border-bottom: 1px solid #eee;
        display: flex;
        justify-content: space-between;
    }
    .result-item:last-child {
        border-bottom: none;
    }
    .result-value {
        font-size: 1.2em;
        color: #007bff;
        font-weight: bold;
    }
    .large-result {
        font-size: 1.5em;
        color: #28a745;
        font-weight: bold;
        text-align: center;
        background-color: #e8f5e8;
        padding: 15px;
        border-radius: 5px;
        margin: 20px 0;
    }
    .error {
        color: #dc3545;
        background-color: #f8d7da;
        border: 1px solid #f5c6cb;
        padding: 10px;
        border-radius: 5px;
        margin-top: 10px;
    }
    .info-box {
        background-color: #e7f3ff;
        border: 1px solid #b3d9ff;
        border-radius: 5px;
        padding: 15px;
        margin: 20px 0;
        color: #0056b3;
    }
    .info-box h4 {
        margin-top: 0;
        color: #0056b3;
    }
    .methodology-note {
        font-size: 0.9em;
        color: #666;
        font-style: italic;
        margin-top: 10px;
    }
    .payment-schedule {
        margin-top: 20px;
        max-height: 300px;
        overflow-y: auto;
        border: 1px solid #ddd;
        border-radius: 5px;
    }
    .payment-schedule table {
        width: 100%;
        border-collapse: collapse;
    }
    .payment-schedule th,
    .payment-schedule td {
        padding: 8px 12px;
        text-align: right;
        border-bottom: 1px solid #eee;
    }
    .payment-schedule th {
        background-color: #f8f9fa;
        font-weight: bold;
        text-align: center;
    }
    .scenario-tabs {
        display: flex;
        margin-bottom: 20px;
        border-bottom: 1px solid #ddd;
    }
    .scenario-tab {
        padding: 10px 20px;
        background: none;
        border: none;
        cursor: pointer;
        border-bottom: 2px solid transparent;
        transition: all 0.3s;
    }
    .scenario-tab.active {
        border-bottom-color: #007bff;
        color: #007bff;
        font-weight: bold;
    }
    .scenario-content {
        display: none;
    }
    .scenario-content.active {
        display: block;
    }
</style>
</head>
<body>
    <!-- Navigation -->
    <nav class="main-nav">
        <div class="container">
            <div class="nav-wrapper">
                <a href="../../index.html" class="logo">
                    <strong>Skerritt Economics</strong>
                    <span>& Consulting</span>
                </a>
                <button class="mobile-menu-toggle" aria-label="Toggle menu">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
                <ul class="nav-menu">
                    <li><a href="../../index.html">Home</a></li>
                    <li class="has-dropdown">
                        <a href="../../services/">Services</a>
                        <ul class="dropdown">
                            <li><a href="../../services/forensic-economics/">Forensic Economics</a></li>
                            <li><a href="../../services/business-valuation/">Business Valuation</a></li>
                        </ul>
                    </li>
                    <li class="has-dropdown">
                        <a href="../../practice-areas/">Practice Areas</a>
                        <ul class="dropdown">
                            <li><a href="../../practice-areas/personal-injury/">Personal Injury & Wrongful Death</a></li>
                            <li><a href="../../practice-areas/medical-malpractice/">Medical Malpractice</a></li>
                            <li><a href="../../practice-areas/employment/">Employment Litigation</a></li>
                            <li><a href="../../practice-areas/commercial-disputes/">Commercial Disputes</a></li>
                        </ul>
                    </li>
                    <li><a href="../../case-studies/">Case Studies</a></li>
                    <li><a href="../../about/">About</a></li>
                    <li><a href="../../resources/">Resources</a></li>
                    <li><a href="../../tools/">Tools</a></li>
                    <li><a href="../../contact/" class="nav-cta">Contact</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Page Header -->
    <section class="page-header">
        <div class="container">
            <h1>Present Value Calculator</h1>
            <p class="lead">Calculate the present value of future economic losses using appropriate discount rates for litigation support.</p>
        </div>
    </section>

    <!-- Tool Content -->
    <section class="tool-content">
        <div class="container">
            <div class="tool-container">
                <div class="tool-header">
                    <h1>Present Value Calculator</h1>
                    <p class="tool-description">
                        Calculate the present value of future economic losses for personal injury, wrongful death, and commercial damages. 
                        This tool supports single payments, periodic payments, and growing payments.
                    </p>
                </div>

                <div class="info-box">
                    <h4>Professional Tool</h4>
                    <p>This calculator uses standard financial methodologies for present value calculations. Results are suitable for economic damage analysis in litigation support.</p>
                </div>

                <!-- Scenario Tabs -->
                <div class="scenario-tabs">
                    <button class="scenario-tab active" onclick="switchScenario('single')">Single Payment</button>
                    <button class="scenario-tab" onclick="switchScenario('periodic')">Periodic Payments</button>
                    <button class="scenario-tab" onclick="switchScenario('growing')">Growing Payments</button>
                </div>
                
                <!-- Single Payment Scenario -->
                <div id="single-scenario" class="scenario-content active">
                    <form id="singleForm">
                        <h3>Single Future Payment</h3>
                        <div class="two-column">
                            <div class="form-group">
                                <label for="single_amount">Future Payment Amount ($):</label>
                                <input type="number" id="single_amount" name="single_amount" step="0.01" required>
                                <div class="input-help">Enter the total future payment amount</div>
                            </div>
                            
                            <div class="form-group">
                                <label for="single_years">Years Until Payment:</label>
                                <input type="number" id="single_years" name="single_years" step="0.1" min="0" required>
                                <div class="input-help">Number of years from today</div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="single_discount_rate">Discount Rate (%):</label>
                            <input type="number" id="single_discount_rate" name="single_discount_rate" step="0.01" min="0" max="20" value="3.5">
                            <div class="input-help">Annual discount rate (e.g., 3.5 for 3.5%)</div>
                        </div>
                        
                        <button type="submit" class="calculate-btn">Calculate Present Value</button>
                    </form>
                </div>

                <!-- Periodic Payments Scenario -->
                <div id="periodic-scenario" class="scenario-content">
                    <form id="periodicForm">
                        <h3>Periodic Payments (Annuity)</h3>
                        <div class="three-column">
                            <div class="form-group">
                                <label for="periodic_payment">Payment Amount ($):</label>
                                <input type="number" id="periodic_payment" name="periodic_payment" step="0.01" required>
                                <div class="input-help">Amount of each payment</div>
                            </div>
                            
                            <div class="form-group">
                                <label for="periodic_frequency">Payment Frequency:</label>
                                <select id="periodic_frequency" name="periodic_frequency" required>
                                    <option value="1">Annual</option>
                                    <option value="12">Monthly</option>
                                    <option value="52">Weekly</option>
                                    <option value="365">Daily</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="periodic_years">Number of Years:</label>
                                <input type="number" id="periodic_years" name="periodic_years" step="0.1" min="0" required>
                                <div class="input-help">Duration of payments</div>
                            </div>
                        </div>
                        
                        <div class="two-column">
                            <div class="form-group">
                                <label for="periodic_discount_rate">Discount Rate (%):</label>
                                <input type="number" id="periodic_discount_rate" name="periodic_discount_rate" step="0.01" min="0" max="20" value="3.5">
                                <div class="input-help">Annual discount rate</div>
                            </div>
                            
                            <div class="form-group">
                                <label for="periodic_timing">Payment Timing:</label>
                                <select id="periodic_timing" name="periodic_timing">
                                    <option value="end">End of Period</option>
                                    <option value="beginning">Beginning of Period</option>
                                </select>
                            </div>
                        </div>
                        
                        <button type="submit" class="calculate-btn">Calculate Present Value</button>
                    </form>
                </div>

                <!-- Growing Payments Scenario -->
                <div id="growing-scenario" class="scenario-content">
                    <form id="growingForm">
                        <h3>Growing Payments (with Inflation/Growth)</h3>
                        <div class="three-column">
                            <div class="form-group">
                                <label for="growing_initial_payment">Initial Payment ($):</label>
                                <input type="number" id="growing_initial_payment" name="growing_initial_payment" step="0.01" required>
                                <div class="input-help">First payment amount</div>
                            </div>
                            
                            <div class="form-group">
                                <label for="growing_frequency">Payment Frequency:</label>
                                <select id="growing_frequency" name="growing_frequency" required>
                                    <option value="1">Annual</option>
                                    <option value="12">Monthly</option>
                                    <option value="52">Weekly</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="growing_years">Number of Years:</label>
                                <input type="number" id="growing_years" name="growing_years" step="0.1" min="0" required>
                                <div class="input-help">Duration of payments</div>
                            </div>
                        </div>
                        
                        <div class="three-column">
                            <div class="form-group">
                                <label for="growing_growth_rate">Growth Rate (%):</label>
                                <input type="number" id="growing_growth_rate" name="growing_growth_rate" step="0.01" min="-10" max="20" value="2.5">
                                <div class="input-help">Annual growth/inflation rate</div>
                            </div>
                            
                            <div class="form-group">
                                <label for="growing_discount_rate">Discount Rate (%):</label>
                                <input type="number" id="growing_discount_rate" name="growing_discount_rate" step="0.01" min="0" max="20" value="3.5">
                                <div class="input-help">Annual discount rate</div>
                            </div>
                            
                            <div class="form-group">
                                <label for="growing_timing">Payment Timing:</label>
                                <select id="growing_timing" name="growing_timing">
                                    <option value="end">End of Period</option>
                                    <option value="beginning">Beginning of Period</option>
                                </select>
                            </div>
                        </div>
                        
                        <button type="submit" class="calculate-btn">Calculate Present Value</button>
                    </form>
                </div>
                
                <div id="results" style="display: none;"></div>
                <div id="error" style="display: none;"></div>
            </div>

            <!-- Tool Information -->
            <div class="tool-info" style="margin-top: 30px;">
                <h3>About This Tool</h3>
                <div class="two-column">
                    <div>
                        <h4>Calculation Types</h4>
                        <ul>
                            <li><strong>Single Payment:</strong> Present value of one future lump sum</li>
                            <li><strong>Periodic Payments:</strong> Present value of regular payments (annuities)</li>
                            <li><strong>Growing Payments:</strong> Present value of payments that increase over time</li>
                        </ul>
                        <p class="methodology-note">Uses standard time value of money principles.</p>
                    </div>
                    <div>
                        <h4>Applications</h4>
                        <ul>
                            <li>Personal injury economic damages</li>
                            <li>Wrongful death calculations</li>
                            <li>Lost profits analysis</li>
                            <li>Structured settlement valuations</li>
                            <li>Commercial damages assessment</li>
                        </ul>
                        <p class="methodology-note">Results suitable for litigation support and expert testimony.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="tool-cta" style="background-color: #f8f9fa; padding: 40px 0; margin-top: 40px;">
        <div class="container">
            <div class="text-center">
                <h2>Need Complex Economic Analysis?</h2>
                <p>While this tool handles standard present value calculations, complex litigation often requires detailed analysis with case-specific factors and expert testimony.</p>
                <a href="../../contact/" class="btn btn-primary btn-large">Discuss Your Case</a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="main-footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-col">
                    <h4>Skerritt Economics & Consulting</h4>
                    <p>Expert forensic economics and business valuation services for legal professionals throughout New England.</p>
                    <p class="footer-contact">
                        400 Putnam Pike Ste J<br>
                        Smithfield, RI 02917<br>
                        <a href="tel:203-605-2814">(203) 605-2814</a><br>
                        <a href="mailto:chris@skerritteconomics.com">chris@skerritteconomics.com</a>
                    </p>
                </div>
                <div class="footer-col">
                    <h4>Services</h4>
                    <ul>
                        <li><a href="../../services/forensic-economics/">Forensic Economics</a></li>
                        <li><a href="../../services/business-valuation/">Business Valuation</a></li>
                        <li><a href="../../services/#life-care-planning">Life Care Planning</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Practice Areas</h4>
                    <ul>
                        <li><a href="../../practice-areas/personal-injury/">Personal Injury</a></li>
                        <li><a href="../../practice-areas/medical-malpractice/">Medical Malpractice</a></li>
                        <li><a href="../../practice-areas/employment/">Employment Litigation</a></li>
                        <li><a href="../../practice-areas/commercial-disputes/">Commercial Disputes</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Resources</h4>
                    <ul>
                        <li><a href="../../case-studies/">Case Studies</a></li>
                        <li><a href="../../resources/">Articles & Insights</a></li>
                        <li><a href="../../tools/">Professional Tools</a></li>
                        <li><a href="../../about/">About Chris Skerritt</a></li>
                        <li><a href="../../contact/">Contact</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Skerritt Economics & Consulting. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="../../js/main.js"></script>

<script>
function switchScenario(scenario) {
    // Hide all scenarios
    document.querySelectorAll('.scenario-content').forEach(content => {
        content.classList.remove('active');
    });
    
    // Remove active class from all tabs
    document.querySelectorAll('.scenario-tab').forEach(tab => {
        tab.classList.remove('active');
    });
    
    // Show selected scenario
    document.getElementById(scenario + '-scenario').classList.add('active');
    
    // Add active class to clicked tab
    event.target.classList.add('active');
    
    // Clear previous results
    document.getElementById('results').style.display = 'none';
    document.getElementById('error').style.display = 'none';
}

// Single Payment Form Handler
document.getElementById('singleForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const formData = new FormData(this);
    const data = Object.fromEntries(formData);
    
    const amount = parseFloat(data.single_amount);
    const years = parseFloat(data.single_years);
    const discountRate = parseFloat(data.single_discount_rate) / 100;
    
    if (amount <= 0 || years < 0 || discountRate < 0) {
        showError('Please enter valid positive numbers for all fields.');
        return;
    }
    
    const presentValue = amount / Math.pow(1 + discountRate, years);
    
    displaySingleResults({
        futureValue: amount,
        presentValue: presentValue,
        years: years,
        discountRate: discountRate * 100,
        discountFactor: 1 / Math.pow(1 + discountRate, years)
    });
});

// Periodic Payments Form Handler
document.getElementById('periodicForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const formData = new FormData(this);
    const data = Object.fromEntries(formData);
    
    const payment = parseFloat(data.periodic_payment);
    const frequency = parseInt(data.periodic_frequency);
    const years = parseFloat(data.periodic_years);
    const discountRate = parseFloat(data.periodic_discount_rate) / 100;
    const timing = data.periodic_timing;
    
    if (payment <= 0 || years <= 0 || discountRate < 0) {
        showError('Please enter valid positive numbers for all fields.');
        return;
    }
    
    const periodicRate = discountRate / frequency;
    const totalPeriods = years * frequency;
    
    let presentValue;
    if (periodicRate === 0) {
        presentValue = payment * totalPeriods;
    } else {
        presentValue = payment * (1 - Math.pow(1 + periodicRate, -totalPeriods)) / periodicRate;
        if (timing === 'beginning') {
            presentValue *= (1 + periodicRate);
        }
    }
    
    const totalFutureValue = payment * totalPeriods;
    
    displayPeriodicResults({
        payment: payment,
        frequency: frequency,
        years: years,
        totalPeriods: totalPeriods,
        presentValue: presentValue,
        totalFutureValue: totalFutureValue,
        discountRate: discountRate * 100,
        timing: timing
    });
});

// Growing Payments Form Handler
document.getElementById('growingForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const formData = new FormData(this);
    const data = Object.fromEntries(formData);
    
    const initialPayment = parseFloat(data.growing_initial_payment);
    const frequency = parseInt(data.growing_frequency);
    const years = parseFloat(data.growing_years);
    const growthRate = parseFloat(data.growing_growth_rate) / 100;
    const discountRate = parseFloat(data.growing_discount_rate) / 100;
    const timing = data.growing_timing;
    
    if (initialPayment <= 0 || years <= 0 || discountRate < 0) {
        showError('Please enter valid positive numbers for all fields.');
        return;
    }
    
    const periodicGrowthRate = growthRate / frequency;
    const periodicDiscountRate = discountRate / frequency;
    const totalPeriods = years * frequency;
    
    let presentValue = 0;
    let totalFutureValue = 0;
    let schedule = [];
    
    for (let period = 1; period <= totalPeriods; period++) {
        const periodPayment = initialPayment * Math.pow(1 + periodicGrowthRate, period - 1);
        const periodPV = periodPayment / Math.pow(1 + periodicDiscountRate, timing === 'beginning' ? period - 1 : period);
        
        presentValue += periodPV;
        totalFutureValue += periodPayment;
        
        if (period <= 120) { // Limit schedule display to first 10 years for monthly, etc.
            schedule.push({
                period: period,
                payment: periodPayment,
                presentValue: periodPV
            });
        }
    }
    
    displayGrowingResults({
        initialPayment: initialPayment,
        frequency: frequency,
        years: years,
        totalPeriods: totalPeriods,
        presentValue: presentValue,
        totalFutureValue: totalFutureValue,
        growthRate: growthRate * 100,
        discountRate: discountRate * 100,
        timing: timing,
        schedule: schedule
    });
});

function displaySingleResults(data) {
    const resultsDiv = document.getElementById('results');
    
    let html = `
        <div class="results">
            <h2>Present Value Calculation Results</h2>
            
            <div class="large-result">
                Present Value: $${formatCurrency(data.presentValue)}
            </div>
            
            <div class="result-section">
                <h3>Calculation Summary</h3>
                <div class="result-item">
                    <span><strong>Future Value:</strong></span>
                    <span class="result-value">$${formatCurrency(data.futureValue)}</span>
                </div>
                <div class="result-item">
                    <span><strong>Years to Payment:</strong></span>
                    <span class="result-value">${data.years}</span>
                </div>
                <div class="result-item">
                    <span><strong>Discount Rate:</strong></span>
                    <span class="result-value">${data.discountRate.toFixed(2)}%</span>
                </div>
                <div class="result-item">
                    <span><strong>Discount Factor:</strong></span>
                    <span class="result-value">${data.discountFactor.toFixed(6)}</span>
                </div>
                <div class="result-item">
                    <span><strong>Discount Amount:</strong></span>
                    <span class="result-value">$${formatCurrency(data.futureValue - data.presentValue)}</span>
                </div>
            </div>
            
            <p class="methodology-note">
                Formula: PV = FV / (1 + r)^n, where PV = Present Value, FV = Future Value, r = discount rate, n = number of years
            </p>
        </div>
    `;
    
    resultsDiv.innerHTML = html;
    resultsDiv.style.display = 'block';
    resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
}

function displayPeriodicResults(data) {
    const resultsDiv = document.getElementById('results');
    const frequencyText = {1: 'Annual', 12: 'Monthly', 52: 'Weekly', 365: 'Daily'}[data.frequency];
    
    let html = `
        <div class="results">
            <h2>Present Value Calculation Results</h2>
            
            <div class="large-result">
                Present Value: $${formatCurrency(data.presentValue)}
            </div>
            
            <div class="result-section">
                <h3>Payment Details</h3>
                <div class="result-item">
                    <span><strong>Payment Amount:</strong></span>
                    <span class="result-value">$${formatCurrency(data.payment)}</span>
                </div>
                <div class="result-item">
                    <span><strong>Payment Frequency:</strong></span>
                    <span class="result-value">${frequencyText}</span>
                </div>
                <div class="result-item">
                    <span><strong>Number of Years:</strong></span>
                    <span class="result-value">${data.years}</span>
                </div>
                <div class="result-item">
                    <span><strong>Total Payments:</strong></span>
                    <span class="result-value">${data.totalPeriods}</span>
                </div>
                <div class="result-item">
                    <span><strong>Payment Timing:</strong></span>
                    <span class="result-value">${data.timing === 'beginning' ? 'Beginning of Period' : 'End of Period'}</span>
                </div>
            </div>
            
            <div class="result-section">
                <h3>Calculation Summary</h3>
                <div class="result-item">
                    <span><strong>Total Future Payments:</strong></span>
                    <span class="result-value">$${formatCurrency(data.totalFutureValue)}</span>
                </div>
                <div class="result-item">
                    <span><strong>Present Value:</strong></span>
                    <span class="result-value">$${formatCurrency(data.presentValue)}</span>
                </div>
                <div class="result-item">
                    <span><strong>Discount Rate:</strong></span>
                    <span class="result-value">${data.discountRate.toFixed(2)}%</span>
                </div>
                <div class="result-item">
                    <span><strong>Total Discount:</strong></span>
                    <span class="result-value">$${formatCurrency(data.totalFutureValue - data.presentValue)}</span>
                </div>
            </div>
            
            <p class="methodology-note">
                Calculation uses standard annuity present value formula with ${data.timing} of period payments.
            </p>
        </div>
    `;
    
    resultsDiv.innerHTML = html;
    resultsDiv.style.display = 'block';
    resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
}

function displayGrowingResults(data) {
    const resultsDiv = document.getElementById('results');
    const frequencyText = {1: 'Annual', 12: 'Monthly', 52: 'Weekly'}[data.frequency];
    
    let scheduleHtml = '';
    if (data.schedule.length > 0) {
        scheduleHtml = `
            <div class="result-section">
                <h3>Payment Schedule (First ${Math.min(data.schedule.length, 120)} Payments)</h3>
                <div class="payment-schedule">
                    <table>
                        <thead>
                            <tr>
                                <th>Period</th>
                                <th>Payment</th>
                                <th>Present Value</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${data.schedule.slice(0, 20).map(item => `
                                <tr>
                                    <td>${item.period}</td>
                                    <td>$${formatCurrency(item.payment)}</td>
                                    <td>$${formatCurrency(item.presentValue)}</td>
                                </tr>
                            `).join('')}
                            ${data.schedule.length > 20 ? '<tr><td colspan="3" style="text-align: center; font-style: italic;">... and ' + (data.schedule.length - 20) + ' more payments</td></tr>' : ''}
                        </tbody>
                    </table>
                </div>
            </div>
        `;
    }
    
    let html = `
        <div class="results">
            <h2>Growing Payments Present Value Results</h2>
            
            <div class="large-result">
                Present Value: $${formatCurrency(data.presentValue)}
            </div>
            
            <div class="result-section">
                <h3>Payment Details</h3>
                <div class="result-item">
                    <span><strong>Initial Payment:</strong></span>
                    <span class="result-value">$${formatCurrency(data.initialPayment)}</span>
                </div>
                <div class="result-item">
                    <span><strong>Payment Frequency:</strong></span>
                    <span class="result-value">${frequencyText}</span>
                </div>
                <div class="result-item">
                    <span><strong>Number of Years:</strong></span>
                    <span class="result-value">${data.years}</span>
                </div>
                <div class="result-item">
                    <span><strong>Total Payments:</strong></span>
                    <span class="result-value">${data.totalPeriods}</span>
                </div>
                <div class="result-item">
                    <span><strong>Growth Rate:</strong></span>
                    <span class="result-value">${data.growthRate.toFixed(2)}%</span>
                </div>
                <div class="result-item">
                    <span><strong>Payment Timing:</strong></span>
                    <span class="result-value">${data.timing === 'beginning' ? 'Beginning of Period' : 'End of Period'}</span>
                </div>
            </div>
            
            <div class="result-section">
                <h3>Calculation Summary</h3>
                <div class="result-item">
                    <span><strong>Total Future Payments:</strong></span>
                    <span class="result-value">$${formatCurrency(data.totalFutureValue)}</span>
                </div>
                <div class="result-item">
                    <span><strong>Present Value:</strong></span>
                    <span class="result-value">$${formatCurrency(data.presentValue)}</span>
                </div>
                <div class="result-item">
                    <span><strong>Discount Rate:</strong></span>
                    <span class="result-value">${data.discountRate.toFixed(2)}%</span>
                </div>
                <div class="result-item">
                    <span><strong>Total Discount:</strong></span>
                    <span class="result-value">$${formatCurrency(data.totalFutureValue - data.presentValue)}</span>
                </div>
            </div>
            
            ${scheduleHtml}
            
            <p class="methodology-note">
                Calculation accounts for ${data.growthRate.toFixed(2)}% annual growth rate applied to each payment period.
            </p>
        </div>
    `;
    
    resultsDiv.innerHTML = html;
    resultsDiv.style.display = 'block';
    resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
}

function showError(message) {
    const errorDiv = document.getElementById('error');
    errorDiv.innerHTML = `<div class="error">${message}</div>`;
    errorDiv.style.display = 'block';
    
    document.getElementById('results').style.display = 'none';
}

function formatCurrency(amount) {
    return amount.toLocaleString('en-US', {
        minimumFractionDigits: 2,
        maximumFractionDigits: 2
    });
}
</script>
</body>
</html>